{% extends "base.html" %}
{% load static %}

{% block title %}Levantamento de Salário{% endblock %}

{% block content %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<div class="saque-page-white">
    <div class="saque-wrapper">
        
        <div class="top-header-clean">
            <a href="{% url 'perfil' %}" class="btn-back-dark">
                <i class="fas fa-arrow-left"></i>
            </a>
            <h1 class="header-title-clean">Salário</h1>
            <div style="width: 24px;"></div> 
        </div>

        <div class="multicaixa-card">
            <div class="mc-chip"></div>
            <div class="mc-brand">MULTICAIXA</div>
            <div class="mc-label">Saldo Disponível</div>
            <div class="mc-balance">{{ request.user.available_balance|default:"0,00" }} <small>KZ</small></div>
            <div class="mc-footer">
                <span class="mc-holder">SISTEMA VIP</span>
                <span class="mc-symbol"><i class="fas fa-signal"></i></span>
            </div>
        </div>

        <div class="form-container-clean">
            {# Mensagens Django #}
            {% if messages %}
                <div class="messages-container">
                    {% for message in messages %}
                        <div class="msg-alert {{ message.tags }}">{{ message }}</div>
                    {% endfor %}
                </div>
            {% endif %}

            {% if not has_bank_details %}
                <div class="bank-warning">
                    <i class="fas fa-university"></i>
                    <p>Adicione suas coordenadas bancárias no Perfil antes de sacar.</p>
                </div>
            {% endif %}

            <form method="post" id="form-saque" class="saque-form">
                {% csrf_token %}
                
                <div class="amount-display-box">
                    <label>Valor Selecionado</label>
                    <div class="input-wrapper-premium">
                        <span class="currency-prefix">KZ</span>
                        <input type="number" name="amount" id="id_amount" 
                               value="{{ form.amount.value|default:'' }}" 
                               readonly required 
                               placeholder="0">
                    </div>
                </div>

                <div class="quick-values-pill-grid">
                    <button type="button" class="pill-btn" onclick="setAmount(3000)">3000</button>
                    <button type="button" class="pill-btn" onclick="setAmount(8000)">8000</button>
                    <button type="button" class="pill-btn" onclick="setAmount(15000)">15000</button>
                    <button type="button" class="pill-btn" onclick="setAmount(50000)">50.000</button>
                    <button type="button" class="pill-btn" onclick="setAmount(100000)">100000</button>
                    <button type="button" class="pill-btn" onclick="setAmount(180000)">180000</button>
                    <button type="button" class="pill-btn" onclick="setAmount(280000)">280000</button>
                    <button type="button" class="pill-btn" onclick="setAmount(500000)">500000</button>
                </div>

                <button type="submit" class="btn-confirm-premium" {% if not has_bank_details %}disabled{% endif %}>
                    EFETUAR LEVANTAMENTO
                </button>
            </form>
        </div>
    </div>
</div>

<style>
    /* Reset e Estabilidade Total */
    * {
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
    }

    body {
        margin: 0;
        padding: 0;
        overflow-x: hidden;
    }

    .saque-page-white {
        background-color: #ffffff;
        min-height: 100vh;
        width: 100%;
        display: flex;
        justify-content: center;
        font-family: 'Segoe UI', Roboto, sans-serif;
    }

    .saque-wrapper {
        width: 100%;
        max-width: 400px;
        background: #ffffff;
        padding: 20px;
        display: flex;
        flex-direction: column;
    }

    .top-header-clean {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 20px;
    }

    .btn-back-dark { color: #1a1a1a; font-size: 1.3rem; text-decoration: none; }
    .header-title-clean { font-size: 1.25rem; font-weight: 700; color: #1a1a1a; margin: 0; }

    /* Cartão Multicaixa Estilizado */
    .multicaixa-card {
        background: linear-gradient(135deg, #004488 0%, #0066cc 100%);
        width: 100%;
        aspect-ratio: 1.6 / 1;
        border-radius: 16px;
        padding: 20px;
        color: white;
        position: relative;
        box-shadow: 0 8px 20px rgba(0, 70, 140, 0.2);
        margin-bottom: 25px;
    }

    .mc-chip { width: 40px; height: 30px; background: linear-gradient(135deg, #f1c40f 0%, #d4ac0d 100%); border-radius: 4px; }
    .mc-brand { position: absolute; top: 20px; right: 20px; font-weight: 800; font-size: 0.9rem; }
    .mc-label { font-size: 0.75rem; text-transform: uppercase; opacity: 0.85; margin-top: 15px; }
    .mc-balance { font-size: 1.8rem; font-weight: 700; }
    .mc-footer { position: absolute; bottom: 20px; left: 20px; right: 20px; display: flex; justify-content: space-between; font-size: 0.75rem; }

    /* Input Exclusivo para Leitura */
    .amount-display-box { text-align: center; margin-bottom: 25px; }
    .amount-display-box label { color: #666; font-size: 0.85rem; margin-bottom: 8px; display: block; }

    .input-wrapper-premium {
        display: flex;
        align-items: center;
        justify-content: center;
        border-bottom: 2px solid #0066cc;
        padding: 5px 0;
        max-width: 220px;
        margin: 0 auto;
    }

    .currency-prefix { font-size: 1.1rem; font-weight: 800; color: #0066cc; margin-right: 8px; }

    .input-wrapper-premium input {
        border: none !important;
        background: transparent !important;
        font-size: 1.8rem !important;
        font-weight: 700 !important;
        color: #1a1a1a !important;
        width: 100%;
        outline: none;
        text-align: left;
        cursor: default; /* Mostra que não é editável */
    }

    /* Grid de Botões */
    .quick-values-pill-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
        margin-bottom: 25px;
    }

    .pill-btn {
        background: #f2f4f7;
        border: 1px solid #eef0f2;
        padding: 10px 2px;
        border-radius: 10px;
        font-size: 0.75rem;
        font-weight: 700;
        color: #444;
        transition: all 0.2s;
        cursor: pointer;
    }

    .pill-btn:active { background: #0066cc; color: white; transform: scale(0.95); }

    .btn-confirm-premium {
        width: 100%;
        background: #0066cc;
        color: white;
        border: none;
        padding: 16px;
        border-radius: 12px;
        font-size: 0.95rem;
        font-weight: 700;
        cursor: pointer;
    }

    .btn-confirm-premium:disabled { background: #cbd5e0; cursor: not-allowed; }

    /* Alertas */
    .bank-warning { background: #fff8e1; border: 1px solid #ffecb3; color: #856404; padding: 12px; border-radius: 10px; font-size: 0.8rem; margin-bottom: 20px; display: flex; align-items: center; gap: 8px; }
    .msg-alert { padding: 10px; border-radius: 8px; text-align: center; margin-bottom: 10px; font-size: 0.85rem; }
    .msg-alert.success { background: #e8f5e9; color: #2e7d32; }
    .msg-alert.error { background: #ffebee; color: #c62828; }

    @media (max-width: 350px) {
        .quick-values-pill-grid { grid-template-columns: repeat(3, 1fr); }
    }
</style>

<script>
    function setAmount(val) {
        // Seleciona o input pelo ID
        const input = document.getElementById('id_amount');
        if (input) {
            input.value = val;
            
            // Efeito visual de confirmação na borda
            const wrapper = document.querySelector('.input-wrapper-premium');
            wrapper.style.borderBottomColor = '#27ae60';
            setTimeout(() => {
                wrapper.style.borderBottomColor = '#0066cc';
            }, 400);
        }
    }
</script>
{% endblock %}
